


```{r}
rm(list = ls())
library(nnet)
chart = read.csv("train_Madison.csv", header = TRUE)

rawdata = chart[c(2, 7:508)]
#model1 = lm(star ~ ., data = rawdata)
#summary(model1)
#trim = which(summary(model1)$coefficients[,4] < 1)
trim = 1:503
model3 = lm (star ~ nchar + nword + gem + incredible + die + knowledgeable
                  + highly + amazing + favorites +  wonderful + perfect + fantastic
                  + notch + favorite + awesome + outstanding + yum + delicious + excellent
                  +perfectly + loved + helpful + unique + yummy + glad + best + love + recommended +
                    recommend + authentic + healthy +enjoyed
                  , data = rawdata[trim])
summary(model3)
aov(model3)
model2 = multinom(star ~ nchar + nword + gem + incredible + die + knowledgeable
                  + highly + amazing + favorites +  wonderful + perfect + fantastic
                  + notch + favorite + awesome + outstanding + yum + delicious + excellent
                  +perfectly + loved + helpful + unique + yummy + glad + best + love + recommended +
                    recommend + authentic + healthy +enjoyed
                  , data = rawdata[trim],MaxNWts = 10000)
summary(model2)
aov(model2)
trim = trim[-1]
trim = trim - 1

test_data = read.csv("test_Madison.csv", header = TRUE)
test_rawdata = test_data[6:507]
coeff = summary(model2)$coefficients[-1,1]
test_trim = test_rawdata[trim]

fit_data = data.matrix(test_trim) %*% data.matrix(coeff)
fit_data = fit_data + summary(model2)$coefficients[1,1]
fit_data[fit_data > 5] = 5
fit_data[fit_data < 1] = 1
result = as.data.frame(test_data[,1])
colnames(result)[1] = "Id"
result$Expected = fit_data
result
write.csv(result, "test_result.csv")

```
